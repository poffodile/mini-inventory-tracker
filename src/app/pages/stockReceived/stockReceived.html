<!-- ========= PAGE: STOCK RECEIVED LOG ========= -->
<div class="space-y-4">
  <!-- Header -->
  <header class="flex items-center justify-between">
    <h1 class="text-2xl font-bold">Stock Received</h1>
    <div class="join">
      <button class="btn btn-outline btn-sm join-item" (click)="toggleSort()">
        Sort: {{ sortDir === 'desc' ? 'Newest first' : 'Oldest first' }}
      </button>
    </div>
  </header>

  <!-- Search -->
  <div class="max-w-sm">
    <label class="form-control">
      <span class="label-text">Search (ID, product, location, refâ€¦)</span>
      <input
        [(ngModel)]="searchText"
        (input)="onSearchInput()"
        type="text"
        class="input input-bordered"
        placeholder="e.g. M001 or 2025-08"
      />
    </label>
  </div>

  <!-- Table -->
  <section class="shadow card bg-base-100">
    <div class="card-body">
      <div class="overflow-x-auto">
        <table class="table table-zebra">
          <thead>
            <tr>
              <th>ID</th>
              <th>Product</th>
              <th>To Location</th>
              <th>Qty</th>
              <th>Ref</th>
              <th>Timestamp</th>
            </tr>
          </thead>
          <tbody>
            @for (m of visible; track m.id) {
            <tr>
              <td>{{ m.id }}</td>
              <td>
                {{ productName(m.productId) }} <span class="opacity-60">({{ m.productId }})</span>
              </td>
              <td>{{ locationName(m.toLocationId) }}</td>
              <td>{{ m.qty }}</td>
              <td>{{ m.ref }}</td>
              <td>{{ m.timestamp | date : 'medium' }}</td>
            </tr>
            }
          </tbody>
        </table>
        <div *ngIf="visible.length === 0" class="mt-3 alert"><span>No matches.</span></div>
      </div>
    </div>
  </section>
</div>
